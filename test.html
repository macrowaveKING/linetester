<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>test</title>
    <script type="text/javascript">
    const jquery = require('./node_modules/jquery/src/jquery.js');
    function formatXml(xml) {
        var formatted = '';
        var reg = /(>)(<)(\/*)/g;
        xml = xml.replace(reg, '$1\r\n$2$3');
        var pad = 0;
        jquery.each(xml.split('\r\n'), function(index, node) {
            var indent = 0;
            if (node.match( /.+<\/\w[^>]*>$/ )) {
                indent = 0;
            } else if (node.match( /^<\/\w/ )) {
                if (pad != 0) {
                    pad -= 1;
                }
            } else if (node.match( /^<\w([^>]*[^\/])?>.*$/ )) {
                indent = 1;
            } else {
                indent = 0;
            }

            var padding = '';
            for (var i = 0; i < pad; i++) {
                padding += '  ';
            }

            formatted += padding + node + '\r\n';
            pad += indent;
        });

        return formatted;
    }

    function inovice(){
      var doc=new DOMParser().parseFromString('<?xml version="1.0" encoding="gbk" ?>');
      var business=doc.createElement('business');
      business.setAttribute('comment','发票开具');
      business.setAttribute('id','FPKJ');
      var body=doc.createElement('body');
      var input=doc.createElement('input')
      var skbht=doc.createTextNode('税控盘编号')
      var skpbh=doc.createElement('skpbh')//税控盘编号
      skpbh.appendChild(skbht)
      input.appendChild(skpbh);
      var  skpklt=doc.createTextNode('税控盘口令')
      var skpkl=doc.createElement('skpkl')//税控盘口令
      skpkl.appendChild(skpklt)
      input.appendChild(skpkl)
      var  keypwdt=doc.createTextNode('数字证书密码')
      var keypwd=doc.createElement('keypwd')//数字证书密码
      keypwd.appendChild(keypwdt)
      input.appendChild(keypwd)
      var  fplxdmt=doc.createTextNode('发票类型代码')
      var fplxdm=doc.createElement('fplxdm')//发票类型代码
      fplxdm.appendChild(fplxdmt)
      input.appendChild(fplxdm)
      var  kplxt=doc.createTextNode('开票类型')
      var kplx=doc.createElement('kplx')//开票类型
      kplx.appendChild(kplxt)
      input.appendChild(kplx)
      var  tspzt=doc.createTextNode('特殊票种标识')
      var tspz=doc.createElement('tspz')//特殊票种标识
      tspz.appendChild(tspzt)
      input.appendChild(tspz)
      var  xhdwsbht=doc.createTextNode('销货单位识别号')
      var xhdwsbh=doc.createElement('xhdwsbh')//销货单位识别号
      xhdwsbh.appendChild(xhdwsbht)
      input.appendChild(xhdwsbh)
      var  xhdwmct=doc.createTextNode('销货单位名称')
      var xhdwmc=doc.createElement('xhdwmc')//销货单位名称
      xhdwmc.appendChild(xhdwmct)
      input.appendChild(xhdwmc)
      var  xhdwdzdht=doc.createTextNode('销货单位地址电话')
      var xhdwdzdh=doc.createElement('xhdwdzdh')//销货单位地址电话
      xhdwdzdh.appendChild(xhdwdzdht)
      input.appendChild(xhdwdzdh)
      var  xhdwyhzht=doc.createTextNode('销货单位银行帐号')
      var xhdwyhzh=doc.createElement('xhdwyhzh')//销货单位银行帐号
      xhdwyhzh.appendChild(xhdwyhzht)
      input.appendChild(xhdwyhzh)
      var  ghdwsbht=doc.createTextNode('购货单位识别号')
      var ghdwsbh=doc.createElement('ghdwsbh')//购货单位识别号
      ghdwsbh.appendChild(ghdwsbht)
      input.appendChild(ghdwsbh)
      var  ghdwmct=doc.createTextNode('购货单位名称')
      var ghdwmc=doc.createElement('ghdwmc')//购货单位名称
      ghdwmc.appendChild(ghdwmct)
      input.appendChild(ghdwmc)

      var  ghdwdzdht=doc.createTextNode('购货单位地址电话')
      var ghdwdzdh=doc.createElement('ghdwdzdh')//购货单位地址电话
      ghdwdzdh.appendChild(ghdwdzdht)
      input.appendChild(ghdwdzdh)
      var  ghdwyhzht=doc.createTextNode('购货单位银行帐号')
      var ghdwyhzh=doc.createElement('ghdwyhzh')//购货单位银行帐号
      ghdwyhzh.appendChild(ghdwyhzht)
      input.appendChild(ghdwyhzh)
      var  bmbbbht=doc.createTextNode('编码表版本号')
      var bmbbbh=doc.createElement('bmbbbh')//编码表版本号
      bmbbbh.appendChild(bmbbbht)
      input.appendChild(bmbbbh)
      var  hsslbst=doc.createTextNode('含税税率标识')
      var hsslbs=doc.createElement('hsslbs')//含税税率标识
      hsslbs.appendChild(hsslbst)
      input.appendChild(hsslbs)


      var fyxm=doc.createElement('fyxm')//
      fyxm.setAttribute('count','1')
      var group=doc.createElement('group')//
      group.setAttribute('xh','1')
      var  fphxzt=doc.createTextNode('发票行性质')
      var fphxz=doc.createElement('fphxz')//发票行性质
      fphxz.appendChild(fphxzt)
      group.appendChild(fphxz)
      var  spmct=doc.createTextNode('商品名称')
      var spmc=doc.createElement('spmc')//商品名称
      spmc.appendChild(spmct)
      group.appendChild(spmc)
      var  spsmt=doc.createTextNode('商品税目')
      var spsm=doc.createElement('spsm')//商品税目
      spsm.appendChild(spsmt)
      group.appendChild(spsm)
      var  ggxht=doc.createTextNode('规格型号')
      var ggxh=doc.createElement('ggxh')//规格型号
      ggxh.appendChild(ggxht)
      group.appendChild(ggxh)
      var  dwt=doc.createTextNode('单位')
      var dw=doc.createElement('dw')//单位
      dw.appendChild(dwt)
      group.appendChild(dw)
      var  spslt=doc.createTextNode('商品数量')
      var spsl=doc.createElement('spsl')//商品数量
      spsl.appendChild(spslt)
      group.appendChild(spsl)
      var  djt=doc.createTextNode('单价')
      var dj=doc.createElement('dj')//单价
      dj.appendChild(djt)
      group.appendChild(dj)
      var  jet=doc.createTextNode('金额')
      var je=doc.createElement('je')//金额
      je.appendChild(jet)
      group.appendChild(je)
      var  kcjet=doc.createTextNode('扣除金额')
      var kcje=doc.createElement('kcje')//扣除金额
      kcje.appendChild(kcjet)
      group.appendChild(kcje)
      var  slt=doc.createTextNode('税率')
      var sl=doc.createElement('sl')//税率
      sl.appendChild(slt)
      group.appendChild(sl)
      var  set=doc.createTextNode('税额')
      var se=doc.createElement('se')//税额
      se.appendChild(set)
      group.appendChild(se)
      var  hsbzt=doc.createTextNode('含税标志')
      var hsbz=doc.createElement('hsbz')//含税标志
      hsbz.appendChild(hsbzt)
      group.appendChild(hsbz)
      var  spbmt=doc.createTextNode('商品编码')
      var spbm=doc.createElement('spbm')//商品编码
      spbm.appendChild(spbmt)
      group.appendChild(spbm)
      var  zxbmt=doc.createTextNode('纳税人自行编码')
      var zxbm=doc.createElement('zxbm')//纳税人自行编码
      zxbm.appendChild(zxbmt)
      group.appendChild(zxbm)
      var  yhzcbst=doc.createTextNode('优惠政策标识')
      var yhzcbs=doc.createElement('yhzcbs')//优惠政策标识
      yhzcbs.appendChild(yhzcbst)
      group.appendChild(yhzcbs)
      var  slbst=doc.createTextNode('0税率标识')
      var slbs=doc.createElement('slbs')//0税率标识
      slbs.appendChild(slbst)
      group.appendChild(slbs)
      var  zzstsglt=doc.createTextNode('增值税特殊管理')
      var zzstsgl=doc.createElement('zzstsgl')//增值税特殊管理
      zzstsgl.appendChild(zzstsglt)
      group.appendChild(zzstsgl)
      fyxm.appendChild(group)
      input.appendChild(fyxm)

      var  empty=doc.createTextNode('')
      var zhsl=doc.createElement('zhsl')//
      input.appendChild(zhsl)
      var  hjjet=doc.createTextNode('合计金额')
      var hjje=doc.createElement('hjje')//合计金额
      hjje.appendChild(hjjet)
      input.appendChild(hjje)
      var  hjset=doc.createTextNode('合计税额')
      var hjse=doc.createElement('hjse')//合计税额
      hjse.appendChild(hjset)
      input.appendChild(hjse)
      var  jshjt=doc.createTextNode('价税合计')
      var jshj=doc.createElement('jshj')//价税合计
      jshj.appendChild(jshjt)
      input.appendChild(jshj)
      var  bzt=doc.createTextNode('备注')
      var bz=doc.createElement('bz')//备注
      bz.appendChild(bzt)
      input.appendChild(bz)
      var  skrt=doc.createTextNode('收款人')
      var skr=doc.createElement('skr')//收款人
      skr.appendChild(skrt)
      input.appendChild(skr)
      var  fhrt=doc.createTextNode('复核人')
      var fhr=doc.createElement('fhr')//复核人
      fhr.appendChild(fhrt)
      input.appendChild(fhr)
      var  kprt=doc.createTextNode('开票人')
      var kpr=doc.createElement('kpr')//开票人
      kpr.appendChild(kprt)
      input.appendChild(kpr)
      var  jmbbht=doc.createTextNode('加密版本号')
      var jmbbh=doc.createElement('jmbbh')//加密版本号
      jmbbh.appendChild(jmbbht)
      input.appendChild(jmbbh)
      var  zyspmct=doc.createTextNode('主要商品名称')
      var zyspmc=doc.createElement('zyspmc')//主要商品名称
      zyspmc.appendChild(zyspmct)
      input.appendChild(zyspmc)
      var  spsmt=doc.createTextNode('商品税目')
      var spsm=doc.createElement('spsm')//商品税目
      spsm.appendChild(spsmt)
      input.appendChild(spsm)
      var  qdbzt=doc.createTextNode('清单标志')
      var qdbz=doc.createElement('qdbz')//清单标志
      qdbz.appendChild(qdbzt)
      input.appendChild(qdbz)
      var  ssyft=doc.createTextNode('所属月份')
      var ssyf=doc.createElement('ssyf')//所属月份
      ssyf.appendChild(ssyft)
      input.appendChild(ssyf)
      var  kpjht=doc.createTextNode('开票机号')
      var kpjh=doc.createElement('kpjh')//开票机号
      kpjh.appendChild(kpjht)
      input.appendChild(kpjh)
      var  tzdbht=doc.createTextNode('通知单编号')
      var tzdbh=doc.createElement('tzdbh')//通知单编号
      tzdbh.appendChild(tzdbht)
      input.appendChild(tzdbh)
      var  yfpdmt=doc.createTextNode('原发票代码')
      var yfpdm=doc.createElement('yfpdm')//原发票代码
      yfpdm.appendChild(yfpdmt)
      input.appendChild(yfpdm)
      var  yfphmt=doc.createTextNode('原发票号码')
      var yfphm=doc.createElement('yfphm')//原发票号码
      yfphm.appendChild(yfphmt)
      input.appendChild(yfphm)
      var  gmcst=doc.createTextNode('签名参数')
      var gmcs=doc.createElement('gmcs')//签名参数
      gmcs.appendChild(gmcst)
      input.appendChild(gmcs)

      business.appendChild(input)

      doc.appendChild(business)
      var request = new XMLSerializer().serializeToString(doc);
      console.log(request);
      request=formatXml(request)
      document.getElementById('xmlloader').innerHTML=request
      //$$("xmlloader").define({value:"<pre>"+request+"</pre>"})
      //$$("xmlloader").refresh();
      alert("test")
    }
    </script>
  </head>
  <body>
    <div class="" id="xmlloader">

    </div>
  </body>
  <script type="text/javascript">
    inovice()
  </script>
</html>
